<!DOCTYPE html>
<html lang="en-gb"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">My bounty infrastructure | Joshua MARTINELLE</title>
<meta property="og:title" content="My bounty infrastructure | Joshua MARTINELLE" />
<meta name="twitter:title" content="My bounty infrastructure | Joshua MARTINELLE" />
<meta itemprop="name" content="My bounty infrastructure | Joshua MARTINELLE" />
<meta name="application-name" content="My bounty infrastructure | Joshua MARTINELLE" />
<meta property="og:site_name" content="Joshua MARTINELLE" />

<meta name="description" content="My bounty infrastructure">
<meta itemprop="description" content="My bounty infrastructure" />
<meta property="og:description" content="My bounty infrastructure" />
<meta name="twitter:description" content="My bounty infrastructure" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />

  <link rel="alternate" hreflang="en-gb" href="http://localhost:1313/posts/2021/my_bounty_infrastructure/" title="" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2021-05-21T06:00:00&#43;0100 />
    <meta property="article:published_time" content=2021-05-21T06:00:00&#43;0100 />
    <meta property="og:url" content="http://localhost:1313/posts/2021/my_bounty_infrastructure/" />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "My bounty infrastructure",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2021-05-21",
        "description": "My bounty infrastructure",
        "wordCount":  1150 ,
        "mainEntityOfPage": "True",
        "dateModified": "2021-05-21",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Joshua MARTINELLE"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.145.0">

    
    <meta property="og:url" content="http://localhost:1313/posts/2021/my_bounty_infrastructure/">
  <meta property="og:site_name" content="Joshua MARTINELLE">
  <meta property="og:title" content="My bounty infrastructure">
  <meta property="og:description" content="My bounty infrastructure">
  <meta property="og:locale" content="en_gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-05-21T06:00:00+01:00">
    <meta property="article:modified_time" content="2021-05-21T06:00:00+01:00">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My bounty infrastructure">
  <meta name="twitter:description" content="My bounty infrastructure">


    

    <link rel="canonical" href="http://localhost:1313/posts/2021/my_bounty_infrastructure/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "light" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav
        class="menu"
        aria-label="Main Navigation"
        style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 10px;
        "
    >
        <div style="display: flex; align-items: center; gap: 10px">
            <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000" width="25" height="25" stroke-width="0.304"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M15 1H1V15H15V1ZM6 5L7.41421 6.41421L5.82843 8L7.41421 9.58579L6 11L3 8L6 5ZM10 5L8.58579 6.41421L10.1716 8L8.58579 9.58579L10 11L13 8L10 5Z" fill="#ffffff"></path> </g></svg>

            <a
                href="/"
                style="font-weight: bold; text-decoration: none; color: inherit"
                >Joshua MARTINELLE</a
            >
        </div>

        <div style="display: flex; align-items: center; margin-right: 2vh">
            <a
                href="https://github.com/JoshuaMART"
                class="logo"
                style="margin-right: 12px; display: block"
            >
                <svg class="mode-sunny" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="currentColor" width="20" height="20"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>GITHUB</title> <desc>Created with Sketch.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="currentColor"> <g id="icons" transform="translate(56.000000, 160.000000)"> <path d="M94,7399 C99.523,7399 104,7403.59 104,7409.253 C104,7413.782 101.138,7417.624 97.167,7418.981 C96.66,7419.082 96.48,7418.762 96.48,7418.489 C96.48,7418.151 96.492,7417.047 96.492,7415.675 C96.492,7414.719 96.172,7414.095 95.813,7413.777 C98.04,7413.523 100.38,7412.656 100.38,7408.718 C100.38,7407.598 99.992,7406.684 99.35,7405.966 C99.454,7405.707 99.797,7404.664 99.252,7403.252 C99.252,7403.252 98.414,7402.977 96.505,7404.303 C95.706,7404.076 94.85,7403.962 94,7403.958 C93.15,7403.962 92.295,7404.076 91.497,7404.303 C89.586,7402.977 88.746,7403.252 88.746,7403.252 C88.203,7404.664 88.546,7405.707 88.649,7405.966 C88.01,7406.684 87.619,7407.598 87.619,7408.718 C87.619,7412.646 89.954,7413.526 92.175,7413.785 C91.889,7414.041 91.63,7414.493 91.54,7415.156 C90.97,7415.418 89.522,7415.871 88.63,7414.304 C88.63,7414.304 88.101,7413.319 87.097,7413.247 C87.097,7413.247 86.122,7413.234 87.029,7413.87 C87.029,7413.87 87.684,7414.185 88.139,7415.37 C88.139,7415.37 88.726,7417.2 91.508,7416.58 C91.513,7417.437 91.522,7418.245 91.522,7418.489 C91.522,7418.76 91.338,7419.077 90.839,7418.982 C86.865,7417.627 84,7413.783 84,7409.253 C84,7403.59 88.478,7399 94,7399" id="github-[#142]"> </path> </g> </g> </g> </g></svg>

            </a>

            <a id="mode" href="#" style="display: block">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="20" height="20" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg> <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="20" height="20" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">My bounty infrastructure</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2021-05-21T06:00:00&#43;01:00" itemprop="datePublished"> 21 May 2021 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img src="/posts/2021/my_bounty_infrastructure/banner.png" alt=""></p>
<p>[31/12/2020] : Updated the post for Rengine to v0.5 and a clearer / cleaner configuration of Traefik as well as the removal of Portainer.</p>
<p>After some problems with Rengine for certificate management and a new service that I want to use, I switched to a full docker infrastructure on my server, apart from the use of a few containers it&rsquo;s my first experience with Docker but after some difficulties I find it rather practical and modular.</p>
<p>So I&rsquo;m sharing with you today the installation of my bounty infrastructure</p>
<h2 id="objective">Objective</h2>
<p>The following services will be installed on your server :</p>
<ul>
<li><a href="https://docs.traefik.io/">Traefik</a> : Container docker of reverse proxy, it will take care of redirecting web traffic to our different containers and it will also manage our SSL certificates via let&rsquo;s encrypt.</li>
<li><a href="https://github.com/daxAKAhackerman/XSS-Catcher">XSS-Catcher</a> : Container docker for XSS blinds.</li>
<li><a href="https://hub.docker.com/_/php">PHP &amp; Apache</a> : Container docker PHP / Apache to host files for our different pocs. I use for example a php file to make redictions when I have a SSRF (cf : <a href="https://www.jomar.fr/posts/2020/03/en-exploiting-my-first-ssrf/">Exploiting my first SSRF</a>).</li>
<li><a href="https://github.com/yogeshojha/rengine/">Rengine</a>: Container docker for subdomain recognition. The v0.5 is really incredible with the addition of <a href="https://github.com/projectdiscovery/nuclei">Nuclei</a></li>
<li><a href="https://github.com/fredsted/webhook.site">WebHook</a> : Container docker for use, test and debug Webhooks and HTTP requests</li>
</ul>
<p><img src="/posts/2021/my_bounty_infrastructure/bnty_docker_schema.png" alt="bnty_docker_schema"></p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>A Ubuntu 20.04 LTS server with at least 4GB of RAM
<ul>
<li>2GB can be enough if you just do small scans with Rengine, the more you run concurrent scans on domains with many subdomains, the more resources it will consume, logic &hellip;</li>
</ul>
</li>
<li>One domain
<ul>
<li>The following DNS entries filled in with :
<ul>
<li><code>traefik.your_domain.tld IN A {your_server_ip}</code></li>
<li><code>poc.your_domain.tld IN CNAME traefik.your_domain.tld</code></li>
<li><code>xss.your_domain.tld IN CNAME traefik.your_domain.tld</code></li>
<li><code>recon.your_domain.tld IN CNAME traefik.your_domain.tld</code></li>
<li><code>webhook.your_domain.tld IN CNAME traefik.your_domain.tld </code></li>
<li><code>your_domain.tld CAA 128 issue &quot;letsencrypt.org&quot;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="disclaimer">Disclaimer</h2>
<p>This is my first installation using Docker, so it&rsquo;s quite likely that it can be upgraded. Feel free to let me know if you can advise me. Moreover, I don&rsquo;t provide support for Docker/Rengine installation/debug, if however you notice an error in my script or if an item is out of date, don&rsquo;t hesitate to tell me.</p>
<h2 id="easy-install">Easy install</h2>
<p>Download <a href="https://jomar.s3.fr-par.scw.cloud/Public/tuto.sh">this script</a>, modify the two variables <code>domain</code> and <code>email</code> and run it, it will take care of installing docker and getting the necessary configurations.</p>
<p>Then perform the following commands:</p>
<pre tabindex="0"><code>cd Traefik &amp;&amp; docker-compose up -d
cd ../ &amp;&amp; cd Poc &amp;&amp; docker-compose up -d
cd ../ &amp;&amp; cd XSS-Catcher &amp;&amp; docker-compose up -d
cd ../ &amp;&amp; cd Rengine &amp;&amp; docker-compose up -d
cd ../ &amp;&amp; cd Webhook &amp;&amp; docker-compose up -d
</code></pre><p>All of your containers should now be started.</p>
<h2 id="configuration-of-each-of-the-containers">Configuration of each of the containers</h2>
<h3 id="traefik">Traefik</h3>
<p>With the new proposed configuration of 24/12/2020, it will first be necessary to change the IP address by yours in the file <code>Traefik/dynamic/middlewares.toml</code>.
You can add one or more IP address with the corresponding mask, to recall /32 for a single IP. This middleware is actually used to add IP protection on some of your containers, so they will only be accessible to people with an authorized IP address.</p>
<p>Check that the <code>/root/Traefik/config/acme.json</code> file is not empty, if this is the case, check your DNS or make sure it is <code>chmod 0600</code>.</p>
<p>You can therefore normally access your Traefik dashboard via <a href="https://traefik.your_domain.tld">https://traefik.your_domain.tld</a>.
This dashboard contains information about entry points, routes, middlewares etc&hellip; in practice you will probably never go on this dashboard in fact.</p>
<p><img src="/posts/2021/my_bounty_infrastructure/bnty_docker_traefik.png" alt="bnty_docker_traefik"></p>
<h3 id="poc">Poc</h3>
<p>This container uses PHP 7.4 as well as Apache.
In fact, I use it to host my payloads files or for example a PHP file to exploit some SSRF (cf : <a href="https://www.jomar.fr/posts/2020/03/en-exploiting-my-first-ssrf/">Exploiting my first SSRF</a>).</p>
<p>When the container starts, it will deliver the files that are in the <code>/root/Poc/www/</code> directory. So if you want to add files or modify existing ones, this is where you should look. They will be directly available at the root of your domain <a href="https://poc.your_domain.tld">https://poc.your_domain.tld</a></p>
<h3 id="xss-catcher">XSS-Catcher</h3>
<p>This container allows me to have my own blind-XSS service, as the name of the title indicates, it&rsquo;s <a href="https://github.com/daxAKAhackerman/XSS-Catcher">XSS-Catcher</a>.</p>
<p>This container takes a good ten minutes to start the first time, so be patient. Then, all you need to do is go to <a href="https://xss.your_domain.tld">https://xss.your_domain.tld</a> and log in with the <code>admin / xss</code> credentials to start using the service.</p>
<p><img src="/posts/2021/my_bounty_infrastructure/bnty_docker_xss.png" alt="bnty_docker_xss"></p>
<h3 id="rengine">Rengine</h3>
<p>The container that gave me the most trouble, but also the one I needed the most &hellip;</p>
<p>I also made several modifications on my side to make it work via Traefik. The basic problem is that the container uses its own reverse proxy that initially manages SSL certificates, except that it doesn&rsquo;t work on Firefox, so I modified the configuration of the Rengine Nginx container to work via Traefik.</p>
<p>Why keep a second reverse proxy would you tell me ? simply because without it you won&rsquo;t have CSS / JS. I didn&rsquo;t look too much but it seems that for example on the login, Rengine checks that you are authenticated before loading the static files, which is of course not the case, the Nginx reverse proxy makes sure to overload its files so that they are returned to you.</p>
<p>Rengine will be accessible via <a href="https://recon.your_domain.tld">https://recon.your_domain.tld</a> as long as you have entered your IP address correctly in <code>Traefik/dynamic/middlewares.toml</code></p>
<p><img src="/posts/2021/my_bounty_infrastructure/bnty_docker_rengine.png" alt="bnty_docker_rengine"></p>
<h2 id="webhook">Webhook</h2>
<p>Pretty handy if you don&rsquo;t have access to burp collaborator or if you don&rsquo;t want to use it. It can also make it easier to manage if you have several requests to make and it&rsquo;s more ergnomic.</p>
<p><img src="/posts/2021/my_bounty_infrastructure/bnty_docker_webhook.png" alt="Bounty Infrastructure - Webhook"></p>
<p>Webhook will be accessible via <a href="https://webhook.your_domain.tld">https://webhook.your_domain.tld</a></p>
<h2 id="add-a-new-container">Add a new container</h2>
<p>In case you want to add a new container, here&rsquo;s what you need to do.</p>
<p>Open the docker-compose.yml of your new service and add the following lines : (If needed, take the example of the containers we just installed :) )</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">networks</span><span class="p">:</span><span class="w"> </span><span class="c">#If the line doesn&#39;t exist add the, otherwise add only the network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">traefik-proxy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">...]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#Don&#39;t forget to change {services} by your services name and {your_sub_domain.tld} by your subdomain.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;traefik.enable=true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;traefik.http.routers.{services}.rule=Host(`{your_sub_domain.tld}`)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;traefik.http.routers.{services}.entrypoints=websecure&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;traefik.http.routers.{services}.tls.certresolver=letsencrypt&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="l">...]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#At the end of file</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>{<span class="nt">services}</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">traefik-global-proxy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>In case your service exposes a port, for example via the <code>port: 8000:8000</code> directive, you can remove the line, it&rsquo;s managed by Traefik :)
If you want to protect your container with IP protection like Rengine and Traefik, simply add the line <code>- &quot;traefik.http.routers.{services}.middlewares=ipwhitelist@file&quot;</code> in labels.</p>
<h2 id="backup--conclusion">Backup &amp; conclusion</h2>
<p>I went from a Proxmox / LXC installation to a full Docker installation and this was not planned but it also makes my backups a lot easier.</p>
<p>I use a service like &ldquo;Bucket S3&rdquo; on Scaleway. And instead of backing up my LXC containers and sending them on my bucket (which is quite a lot of weight) I just have to send my docker-composites, configuration files and the files I want to back up.</p>
<p>This also facilitates restoration in the event of a complete crash. Rather than reinstalling a Proxmox and reimporting each LXC container, I just have to unroll the script that is at the beginning of this tutorial on a new server.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        © 2025 .
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
